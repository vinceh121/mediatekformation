{% extends "base.html.twig" %}

{% block bodyclasses %}
container-fluid
{% endblock %}

{% block stylesheets %}
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
{% endblock %}

{% block javascripts %}
<script src="https://code.jquery.com/jquery-3.7.1.slim.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.js"></script>
{% endblock %}

{% block body %}
<div class="row">
  <div class="col">
    <h3>Formations</h3>
    <table id="tblFormations" aria-label="Formations" class="table">
      <thead>
        <tr>
          <th>#</th>
          <th>Titre</th>
          <th>Date de publication</th>
          <th>Vid√©o</th>
          <th>Playlist</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for f in formations %}
        <tr>
          <td scope="row" class="text-muted">
            {{ f.id }}
          </td>
          <td>
            {{ f.title }}
          </td>
          <td title="{{ f.publishedAt | format_datetime('full', locale='fr') }}">
            {{ f.publishedAt | format_datetime('relative_short', locale='fr') }}
          </td>
          <td>
            <a class="fs-2" target="_blank" href="https://youtube.com/watch?v={{ f.videoId }}">
              <i class="bi bi-youtube"></i>
            </a>
          </td>
          <td>
            <a class="fs-2" href="{# path('admin_playlist', {playlistId: f.playlist.id}) #}">
              <i class="bi bi-card-list"></i>
            </a>
          </td>
          <td>
            <div class="dropdown">
              <button class="btn" type="button" id="formActions{{ f.id }}" data-bs-toggle="dropdown"
                aria-expanded="false">
                <i class="fs-3 bi bi-three-dots-vertical"></i>
              </button>
              <ul class="dropdown-menu" aria-labelledby="formActions{{ f.id }}">
                <li>
                  <a class="dropdown-item" href="#">Modifier</a>
                </li>
                <li>
                  <a class="dropdown-item text-white bg-danger" href="#">Supprimer</a>
                </li>
              </ul>
            </div>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  <div class="col">
    <h3>Playlists</h3>
  </div>
</div>
{% endblock %}

{% block domJavascripts %}
<script type="text/javascript">
fetch('https://cdn.datatables.net/plug-ins/1.13.6/i18n/fr-FR.json')
  .then(res => res.json())
  .then(fr => {
    const tblFormations = new DataTable('#tblFormations', {
      language: fr,
      columnDefs: [
        {
          target: 3,
          orderable: false
        },
        {
          target: 4,
          orderable: false
        },
        {
          target: 5,
          orderable: false
        }
      ]
    });
  });
</script>
{% endblock %}
